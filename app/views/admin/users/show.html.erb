<div class="d-flex justify-content-between align-items-start mb-4">
  <div class="d-flex align-items-center">
    <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center" style="width: 64px; height: 64px;">
      <span class="fs-4"><%= @user.first_name[0] %><%= @user.last_name[0] %></span>
    </div>
    <div class="ms-3">
      <h1 class="h3 mb-1"><%= @user.display_name %></h1>
      <p class="text-muted mb-0"><%= @user.email %></p>
    </div>
  </div>
  <div class="d-flex gap-2">
    <%= link_to edit_admin_user_path(@user), class: "btn btn-outline-secondary" do %>
      <i class="bi bi-pencil me-1"></i> Edit
    <% end %>
    <% if @user.active? && @user != current_user %>
      <%= button_to deactivate_admin_user_path(@user), method: :patch, class: "btn btn-outline-danger", data: { turbo_confirm: "Deactivate this user?" } do %>
        <i class="bi bi-x-circle me-1"></i> Deactivate
      <% end %>
    <% elsif !@user.active? %>
      <%= button_to activate_admin_user_path(@user), method: :patch, class: "btn btn-outline-success" do %>
        <i class="bi bi-check-circle me-1"></i> Activate
      <% end %>
    <% end %>
  </div>
</div>

<div class="row g-4">
  <div class="col-lg-8">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">User Information</h5>
        <dl class="row mt-3">
          <dt class="col-sm-3 text-muted">Full Name</dt>
          <dd class="col-sm-9"><%= @user.display_name %></dd>

          <dt class="col-sm-3 text-muted">Email</dt>
          <dd class="col-sm-9"><%= @user.email %></dd>

          <dt class="col-sm-3 text-muted">Status</dt>
          <dd class="col-sm-9">
            <% if @user.active? %>
              <span class="badge bg-success">Active</span>
            <% else %>
              <span class="badge bg-secondary">Inactive</span>
            <% end %>
          </dd>

          <dt class="col-sm-3 text-muted">Roles</dt>
          <dd class="col-sm-9">
            <% @user.roles.each do |role| %>
              <span class="badge bg-primary me-1"><%= role.name.humanize %></span>
            <% end %>
            <% if @user.roles.empty? %>
              <span class="text-muted">No roles assigned</span>
            <% end %>
          </dd>
        </dl>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Activity</h5>
        <dl class="row mt-3">
          <dt class="col-sm-3 text-muted">Created</dt>
          <dd class="col-sm-9"><%= @user.created_at.strftime("%B %d, %Y") %></dd>

          <dt class="col-sm-3 text-muted">Last Sign In</dt>
          <dd class="col-sm-9"><%= @user.last_sign_in_at ? @user.last_sign_in_at.strftime("%B %d, %Y at %I:%M %p") : "Never" %></dd>

          <dt class="col-sm-3 text-muted">Sign In Count</dt>
          <dd class="col-sm-9"><%= @user.sign_in_count || 0 %></dd>

          <% if @user.current_sign_in_ip %>
            <dt class="col-sm-3 text-muted">Last IP</dt>
            <dd class="col-sm-9"><%= @user.current_sign_in_ip %></dd>
          <% end %>
        </dl>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Permissions</h5>
        <ul class="list-unstyled mt-3 mb-0">
          <li class="mb-2">
            <i class="bi <%= @user.admin? ? 'bi-check-circle text-success' : 'bi-x-circle text-muted' %> me-2"></i>
            Administrator
          </li>
          <li class="mb-2">
            <i class="bi <%= @user.recruiter? ? 'bi-check-circle text-success' : 'bi-x-circle text-muted' %> me-2"></i>
            Recruiter
          </li>
          <li class="mb-2">
            <i class="bi <%= @user.hiring_manager? ? 'bi-check-circle text-success' : 'bi-x-circle text-muted' %> me-2"></i>
            Hiring Manager
          </li>
          <li>
            <i class="bi <%= @user.has_role?('interviewer') ? 'bi-check-circle text-success' : 'bi-x-circle text-muted' %> me-2"></i>
            Interviewer
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<div class="mt-4">
  <%= link_to admin_users_path, class: "text-decoration-none" do %>
    <i class="bi bi-arrow-left me-1"></i> Back to Users
  <% end %>
</div>
